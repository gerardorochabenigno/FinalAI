import openai
import yaml

def cargar_config_llm(path="config/config.yaml"):
    with open(path, "r") as f:
        config = yaml.safe_load(f)
    return config.get("openai", {})

def get_llm_response(prompt, model="gpt-4", temperature=0.3, max_tokens=500):
    openai_config = cargar_config_llm()
    api_key = openai_config.get("api_key")

    if not api_key:
        raise ValueError("No se encontr√≥ la API key de OpenAI en config/config.yaml")

    openai.api_key = api_key

    response = openai.ChatCompletion.create(
        model=model,
        messages=[{"role": "user", "content": prompt}],
        temperature=temperature,
        max_tokens=max_tokens
    )

    return response["choices"][0]["message"]["content"].strip()